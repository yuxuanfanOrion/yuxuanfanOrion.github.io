<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script src="{{ base_path }}/assets/js/main.min.js"></script>

<!-- Back to Top Button -->
<script>
$(document).ready(function() {
  // Create back-to-top button
  $('body').append('<a href="#" class="back-to-top">Top</a>');

  // Show/hide button based on scroll position
  $(window).scroll(function() {
    if ($(this).scrollTop() > 200) {
      $('.back-to-top').fadeIn();
    } else {
      $('.back-to-top').fadeOut();
    }
  });

  // Smooth scroll to top
  $('.back-to-top').click(function(e) {
    e.preventDefault();
    $('html, body').animate({scrollTop: 0}, 500);
  });
});
</script>

<!-- Star Background Rotation -->
<script>
$(document).ready(function() {
  var starImages = [
    '/images/stars-bg/star-01.jpg',
    '/images/stars-bg/star-02.jpg',
    '/images/stars-bg/star-03.jpg',
    '/images/stars-bg/star-04.jpg',
    '/images/stars-bg/star-05.jpg',
    '/images/stars-bg/star-06.jpg',
    '/images/stars-bg/star-07.jpg',
    '/images/stars-bg/star-08.jpg',
    '/images/stars-bg/star-09.jpg',
    '/images/stars-bg/star-10.jpg',
    '/images/stars-bg/star-11.jpg',
    '/images/stars-bg/star-12.jpg',
    '/images/stars-bg/star-13.jpg',
    '/images/stars-bg/star-14.jpg',
    '/images/stars-bg/star-15.jpg',
    '/images/stars-bg/star-16.jpg',
    '/images/stars-bg/star-17.jpg',
    '/images/stars-bg/star-18.jpg',
    '/images/stars-bg/star-19.jpg',
    '/images/stars-bg/star-20.jpg'
  ];

  var currentIndex = 0;
  var cover = $('#profile-cover');

  if (cover.length) {
    cover.append('<div class="bg-layer bg-layer-1"></div>');
    cover.append('<div class="bg-layer bg-layer-2"></div>');

    var layer1 = cover.find('.bg-layer-1');
    var layer2 = cover.find('.bg-layer-2');

    // 初始化：layer1在底层显示，layer2在上层隐藏
    layer1.css({
      'background-image': 'url(' + starImages[0] + ')',
      'opacity': 1,
      'z-index': 1
    });
    layer2.css({
      'opacity': 0,
      'z-index': 2
    });

    setInterval(function() {
      currentIndex = (currentIndex + 1) % starImages.length;

      // 预加载新图片
      var img = new Image();
      img.onload = function() {
        // 设置上层图片并淡入
        layer2.css('background-image', 'url(' + starImages[currentIndex] + ')');
        layer2.animate({opacity: 1}, 2000, function() {
          // 淡入完成后，把新图片设置到底层，重置上层
          layer1.css('background-image', 'url(' + starImages[currentIndex] + ')');
          layer2.css('opacity', 0);
        });
      };
      img.src = starImages[currentIndex];
    }, 10000);
  }
});
</script>

{% include analytics.html %}
